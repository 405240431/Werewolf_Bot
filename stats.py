'''

                    -= Werewolves Data Collection Module =-

                     -= Our Lord and Saviour, The Zucc =-

@@@@@@@@@@@@@@@@@@@@@@@@@@@@%//((/((((((#((##(%&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@#///((((((////((/**/(((((((/%@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@%/((/(#(((///(/,,,***,*,***///*//@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@#*///**///*/******,......,,,*,****///(@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@(///***,*/(/*,,,,...,,*(*,.,,,,**/(*,*///#@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@#*/////*,,****,...,**//((*,,...,*/*,/*,*/*//%@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@///,,/*,,****,,..,,,.,**,,,**,,,,,,.,,,,,*//((#@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@(/*,,**,,,..****//((#####(/**/(#%#*(###(,.,***/%@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@&,*/,*/*..,****//((((###%%%%&&&&&&&&&&&&%#/**//**#@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@%,,*.//(,,*//**/((((#####%%%&&&&&&&&&&&&&&%/****//@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@#,*,,,,..*/#(#(/(((#####%%%%&&&&&&&&&&&&&&%#//****@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@%*,,,....*/((##((((##%%%%%&&&&&&&&&&&&&&&&&%#/.,,,@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@*,,.....*((%%(/****//(##%%%&&&&&&&&&&&&&&%%%(,**(@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@/*.,...,##%#**/((##(////(%%%%%%#((/((#%%%%%#*..*/#//@@@@@@@@@@@
@@@@@@@@@@@@@@@&***,.,./&%#/*****/((///**(#&&%#((((#%%&%##%#.,,,*//%@@@@@@@@@@@
@@@@@@@@@@@@@@@&,,*/**/#&%/****,*..//,***(%&&(**,,/###%%%(...,,/@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@,,**/**%%%(/(///((((((/**(#%&&&%((*.*(/#%%%(.*/,,(@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@%**,,**#%%#((###(((((/***(#%%&&#(#%&%%&&%(%##,,@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@(,,,(%#####(##%###(//***(#&%&&&&&&&&&&&&&%(/*#@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@/(#*####(((#####((/****/#&&&&&&&&&&&&&&(%%(%@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@(/((((//((###(/*****((#&&%%%%&&&&&&&&##&@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@%//((((///(((/*******/#%&&%%%#(#%&&&&&%%%&@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@&(//**//******,,,,***/(#%%%#*(#%%%%%&&@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@(/***((*********/((#%%%%%&%*/(#%##%&@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@&(/**/((/**  ******/*/((####//#%%#%&@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@&(//**/((//**,.*/#%%%%%%,/%%##%%%%&@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@&((/***/(//***//(((((((#%&&%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@&(((/***////**////((##%%&&&%%%%#%@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@((((/***/(//////(((##%%%&&%%%##&@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@(((((/////(#(######%%%&&&%%##(&@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@(((#(//////(##%%%%%&&&&&%##(#%@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@#((#((////**/##%%%&&&&%%#((%%%@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@#((##(/*******/((#####(((#%%%%&@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@%((##(/***,,,,,,,,,*/(##%%%%&%#%%(*//(%@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@%###((((/********//((##%%%%&&&&%%%%#****(//%@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@##(#((#((((/****///(((##%%%%%%%&&%%%%#********//(#@@@@@@@@@@@
@@@@@@@@@@@@((((((((//#(((//****//(((##%%%%%%%%%%%%%(**,**/****///(((&@@@@@@@
@@@@@@@@@%#(((((((///(//#(////****//((###%%%%%%%%%%%#*,,,**/***////////((((#%@@
@@@@@%#(*/((((((//**////%#///****//(((#####%%%%%%%*,,,,***/*******/////////(((#
@@@#((/////////((((((/**##(/*****///(((((######(,,,,,**/*****/////*******//////
@%((///////*****//(/((/**(((*******///((((((/,,,,,,***************,*/********//
@(/*///************//((**,*//*****/////*,,...,,,,*******,,,,,,,,,,,,,,,**/*****
%/*****/***********,,*//*,,,.   .........,,,,****,,,,,,,,,,,,,,,,,,,,*****,*//*
(,.,*****///******/*********,.......,,,,*,,,,,,,,,,,,,,,,,,,,,,,,,,,****,,,,,**
/, .,********//*********,,,,..,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,**,,,,,,,,,**
/.  .**********/*******,,,,,,,,.....,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.,**

                  "We do not sell data to advertisers"
                  "Violating your privacy since 2004â„¢"
                             - The Zucc
'''

import json


def get_stats():
    """Returns the current stats from the file as a JSON object"""
    try:
        with open('stats.json') as f:
            return json.load(f)
    except:
        print("WARNING: Stats file is invalid! Writing a new one.")
        write_stats({"users":{}})
def write_stats(stats):
    """Writes the stats to the file"""
    with open('stats.json', 'w') as outfile:
        json.dump(stats, outfile)

def reset_stats(confirm):
    """Overwrites all stats, ever"""
    if confirm:
        write_stats({"users":{}})
        return True
    return False

def increment_stat(stat, amount):
    """Increments {stat} by {amount}"""
    stats = get_stats()
    try:
        stats[stat] += amount
    except:
        stats[stat] = amount
    write_stats(stats)

def get_stat(stat):
    """Returns the value of {stat}"""
    return get_stats()[stat]

def get_user_stat(user_id, stat):
    """Returns {user_id}'s {stat}"""
    return get_stats()["users"][user_id][stat]

def increment_user_stat(user_id, stat, value):
    """Returns {user_id}'s {stat}"""
    stats = get_stats()
    if not user_id in stats["users"]:
        stats["users"][user_id] = {} # Initialise user ID
    try:
        stats["users"][user_id][stat] += value
    except:
        stats["users"][user_id][stat] = value
    write_stats(stats)
